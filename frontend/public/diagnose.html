<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CircuitAI - è¯Šæ–­é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <h1>ğŸ” CircuitAI é—®é¢˜è¯Šæ–­</h1>
    
    <div id="diagnostics"></div>
    
    <h2>ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ</h2>
    <button onclick="clearCache()">æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</button>
    <button onclick="disableExtensions()">æ£€æŸ¥æ‰©å±•ç¨‹åº</button>
    <button onclick="testIncognito()">æ— ç—•æ¨¡å¼æµ‹è¯•</button>
    
    <script>
        function runDiagnostics() {
            const diagnostics = document.getElementById('diagnostics');
            let html = '<h2>ğŸ“Š è¯Šæ–­ç»“æœ</h2>';
            
            // æ£€æŸ¥ç”¨æˆ·ä»£ç†
            html += `<div class="status info">
                <strong>æµè§ˆå™¨:</strong> ${navigator.userAgent}
            </div>`;
            
            // æ£€æŸ¥å½“å‰URL
            html += `<div class="status info">
                <strong>å½“å‰åœ°å€:</strong> ${window.location.href}
            </div>`;
            
            // æ£€æŸ¥æ§åˆ¶å°é”™è¯¯
            const errors = [];
            const originalError = console.error;
            console.error = function(...args) {
                errors.push(args.join(' '));
                originalError.apply(console, args);
            };
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ref.jsé”™è¯¯
            setTimeout(() => {
                const hasRefError = errors.some(err => err.includes('ref.js'));
                if (hasRefError) {
                    html += `<div class="status error">
                        <strong>å‘ç°ref.jsé”™è¯¯!</strong> è¿™é€šå¸¸ç”±ä»¥ä¸‹åŸå› å¼•èµ·ï¼š<br>
                        1. Google AdSense è„šæœ¬é—®é¢˜<br>
                        2. æµè§ˆå™¨æ‰©å±•å¹²æ‰°<br>
                        3. ç¼“å­˜é—®é¢˜
                    </div>`;
                } else {
                    html += `<div class="status success">
                        <strong>æœªæ£€æµ‹åˆ°ref.jsé”™è¯¯</strong>
                    </div>`;
                }
                diagnostics.innerHTML = html;
            }, 2000);
            
            // æ£€æŸ¥æ‰©å±•ç¨‹åº
            if (window.chrome && chrome.runtime) {
                html += `<div class="status info">
                    <strong>æ£€æµ‹åˆ°Chromeæ‰©å±•ç¨‹åº</strong> - å¯èƒ½å¯¼è‡´è„šæœ¬å†²çª
                </div>`;
            }
            
            // æ£€æŸ¥ç½‘ç»œè¿æ¥
            if (navigator.onLine) {
                html += `<div class="status success">
                    <strong>ç½‘ç»œè¿æ¥:</strong> æ­£å¸¸
                </div>`;
            } else {
                html += `<div class="status error">
                    <strong>ç½‘ç»œè¿æ¥:</strong> ç¦»çº¿
                </div>`;
            }
            
            diagnostics.innerHTML = html;
        }
        
        function clearCache() {
            alert('è¯·æŒ‰ Ctrl+Shift+Delete æ‰“å¼€æ¸…é™¤æ•°æ®çª—å£ï¼Œé€‰æ‹©"ç¼“å­˜å›¾åƒå’Œæ–‡ä»¶"ï¼Œç„¶åé‡æ–°åŠ è½½é¡µé¢ã€‚');
        }
        
        function disableExtensions() {
            alert('è¯·ï¼š\\n1. ç‚¹å‡»Chromeå³ä¸Šè§’ä¸‰ä¸ªç‚¹èœå•\\n2. é€‰æ‹©"æ‰©å±•ç¨‹åº" > "ç®¡ç†æ‰©å±•ç¨‹åº"\\n3. æš‚æ—¶ç¦ç”¨æ‰€æœ‰æ‰©å±•ç¨‹åº\\n4. é‡æ–°åŠ è½½é¡µé¢æµ‹è¯•');
        }
        
        function testIncognito() {
            alert('è¯·æŒ‰ Ctrl+Shift+N æ‰“å¼€æ— ç—•æ¨¡å¼ï¼Œç„¶åè®¿é—®ç½‘ç«™æµ‹è¯•æ˜¯å¦æ­£å¸¸ã€‚');
        }
        
        // é¡µé¢åŠ è½½åè¿è¡Œè¯Šæ–­
        window.onload = runDiagnostics;
        
        // æ•è·æœªå¤„ç†çš„é”™è¯¯
        window.onerror = function(msg, url, line, col, error) {
            const diagnostics = document.getElementById('diagnostics');
            diagnostics.innerHTML += `<div class="status error">
                <strong>JavaScripté”™è¯¯:</strong> ${msg}<br>
                <strong>æ–‡ä»¶:</strong> ${url}:${line}:${col}
            </div>`;
            return false;
        };
    </script>
</body>
</html>