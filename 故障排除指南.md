# CircuitAI 故障排除指南

## 常见问题快速解决

### 🚨 API连接问题 (405错误)

**症状**: 前端显示"405 Method Not Allowed"错误

**原因**: API请求发送到了Pages而不是Workers

**解决方案**:
1. 检查 `frontend/src/services/api.ts` 中的 `getApiBaseUrl()` 函数
2. 确保返回: `https://circuitai-api.peyoba660703.workers.dev/api`
3. 重新构建并部署前端

**验证命令**:
```bash
# 测试Workers API (应该成功)
curl https://circuitai-api.peyoba660703.workers.dev/api/health

# 测试Pages API (会失败)
curl https://circuitai.pages.dev/api/health
```

### 🔧 服务架构说明

```
用户浏览器
    ↓
📄 Cloudflare Pages (前端)
    ↓ API请求
⚡ Cloudflare Workers (后端API)
```

- **Pages**: 只托管静态文件 (HTML/CSS/JS)
- **Workers**: 处理所有API请求

### 📋 快速检查清单

API问题排查:
- [ ] 检查请求URL是否指向Workers域名
- [ ] 验证Workers服务是否正常运行
- [ ] 确认前端已重新构建和部署
- [ ] 检查浏览器控制台的实际请求地址

### 🚀 常用命令

```bash
# 构建前端
cd frontend && npm run build

# 部署前端到Pages
npx wrangler pages deploy frontend/dist --project-name circuitai --branch main

# 部署Workers
cd workers && npx wrangler deploy

# 测试API
curl -X GET https://circuitai-api.peyoba660703.workers.dev/api/health
```

### 📞 联系信息

如果问题仍然存在，请查看:
- `docs/development/API连接问题解决记录_2025-08-17.md`
- GitHub Issues
- 开发日志文档

---
*最后更新: 2025-08-17*
